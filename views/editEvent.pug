doctype html
head
  meta(charset='utf-8')
  meta(name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no')
  link(rel='stylesheet' href='https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css' integrity='sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO' crossorigin='anonymous')
  script(src='https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js')
  script(src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js' integrity='sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49' crossorigin='anonymous')
  script(src='https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js' integrity='sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy' crossorigin='anonymous')
  title Edit event
  style.
    .required-input:after{
    content:"*";
    color:red;
    }

nav.navbar.navbar-expanded.navbar-light.bg-light
  ul.nav.nav-pills
    li.nav-item
      a.nav-link(href='index.html') Home
    li.nav-item
      a.nav-link(href='schedule.html') Schedule
    li.nav-item.active
      a.nav-link(href='addEvent.html')
        | Add
        | Event
    li.nav-item
      a.nav-link(href='logout') Log out
br
br
.container.mb-5
  form#addEvent(name='addEvent' method='post' action='/postEditEvent')
    input(type='hidden' name='id' value=event_id)
    .form-group
      label.required-input(for='nameInput') Event
      input#nameInput.form-control(type='text' name='event' pattern='[a-zA-Z0-9\\s]+' title='Event must be alphanumeric' required='' value=event_event)
      small#eventHelp.form-text.text-muted
        | Event name must be alphanumeric
    .form-group
      label.required-input(for='dayInput') Day of Week
      select#dayInput.form-control(name='day')
        each day in ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday']
          option(selected=(day===event_day))= day
    .form-group
      label.required-input(for='startTimeInput') Start
      input#startTimeInput.form-control(type='time' name='start' required='' value=event_start)
    .form-group
      label.required-input(for='endTimeInput') End
      input#endTimeInput.form-control(type='time' name='end' required='' value=event_end)
    .form-group
      label(for='phoneInput') Phone
      input#phoneInput.form-control(type='text' name='phone' value=event_phone)
    .form-group
      label(for='locationInput') Location
      input#locationInput.form-control(type='text' name='location' value=event_location)
    .form-group
      label(for='extraInput') Extra Info
      input#extraInput.form-control(type='text' name='info' value=event_info)
    .form-group
      label(for='urlInput') Enter URL for the Extra Info
      input#urlInput.form-control(type='url' name='url' value=event_url)
    button.btn.btn-block.btn-primary(type='submit') Submit
    button.btn.btn-block.btn-secondary(type='button' onclick='checkOverlap()' data-toggle='tooltip' data-placement='top' title='Checks if this event interferes with any on your existing schedule') Check for Overlap
    #overlapAlert.container.mt-3
script.
  function createAlert(count, events) {
  let listItems = events.map((event) =>
  `<li class="list-group-item">${event.event} from ${event.start} to ${event.end} on ${event.day}`)
  .join('');
  let newHtml = `
  <div class="alert alert-warning" role="alert" >
  This event interferes with ${count} others:
  <ul class="list-group">
  ${listItems}
  </ul>
  </div>
  `;
  $('#overlapAlert').html(newHtml);
  }
  function removeAlert() {
  let newHtml = `
  <div class="alert alert-success" role="alert">
  This event does not interfere with any others.
  </div>`;
  $('#overlapAlert').html(newHtml);
  }
  //TODO: if doing the bonus, complete checking for overlap
  function checkOverlap() {
  let day = document.getElementById('dayInput').value
  let start = document.getElementById('startTimeInput').value
  let end = document.getElementById('endTimeInput').value
  fetch(`/eventInterferes?day=${day}&start=${start}&end=${end}`).then((response)=>response.json()).then((info)=>{
  if(info.length==0){
  removeAlert()
  }
  else{
  createAlert(info.length,info)
  }
  })
  }
